# Home Assistant Add-on: ONNX ASR

Локальный сервер распознавания речи (STT) для Home Assistant на базе [onnx-asr](https://github.com/istupakov/onnx-asr).

## Установка

1.  Перейдите в ваш Home Assistant.
2.  Откройте **Настройки > Дополнения > Магазин дополнений**.
3.  Если вы еще не добавили репозиторий, нажмите на три точки в правом верхнем углу, выберите **"Репозитории"**, вставьте URL `https://github.com/mitrokun/hassio-addons` и нажмите **"Добавить"**.
4.  Найдите аддон "ONNX ASR" в магазине и нажмите **"Установить"**.

## Как использовать

После установки надо выбрать модель и запустить аддон. Система может автоматически обнаружить новую службу для интеграции wyoming.
Если это не произошло, используйте название контейнера, как хост, и порт 10305. Название находится на главной странцие запущенного аддона или в адрессной строке.

[![Open your Home Assistant instance and start setting up a new integration.](https://my.home-assistant.io/badges/config_flow_start.svg)](https://my.home-assistant.io/redirect/config_flow_start/?domain=wyoming)

После этого вы сможете выбрать "ONNX ASR" в качестве STT в настройках голосовых ассистентов.

## Модели и хранение

При первом запуске с выбранной моделью аддон автоматически скачает ее из интернета. Чтобы избежать повторной загрузки при обновлениях, модели сохраняются в папку `share` вашего Home Assistant.

**Путь хранения моделей:** `/share/onnxasr/.cache/`

## Конфигурация

### Опция: `model`

Выбор модели для распознавания речи. Модели отличаются размером, скоростью и точностью. Для русского актуальны `gigaam-v2-ctc` [900/240], `vosk-model-ru` [260/75], `vosk-model-small-ru` [90/25], в скобках полный размер и int8.

### Опция: `int8_quantization`

Выбор int8 квантизации модели. Влияет на размер моделии скорость работы. Доступно не для всех моделей.


### Опция: `device`

Устройство для вычислений:
-   **cpu**: Стандартный вариант, работает на любом устройстве.
-   **cuda**: **Внимание!** Не выбирать. функция поддерживается программой, но не работает в аддоне, так как в HAOS нет драйверов и библиотек. Запускайте оригинальный [сервер](https://github.com/mitrokun/wyoming_stt_onnxasr) на машине с onnxruntime-gpu, если есть необходимость.

### Опция: `debug`

Включает подробное логирование в журнале аддона. Полезно для диагностики проблем.
