# Home Assistant Add-on: ONNX ASR

Локальный сервер распознавания речи (STT) для Home Assistant на базе [ONNX ASR](https://github.com/istupakov/onnx-asr).

## Установка

1.  Перейдите в ваш Home Assistant.
2.  Откройте **Настройки > Дополнения > Магазин дополнений**.
3.  Если вы еще не добавили репозиторий, нажмите на три точки в правом верхнем углу, выберите **"Репозитории"**, вставьте URL `https://github.com/mitrokun/hassio-addons` и нажмите **"Добавить"**.
4.  Найдите аддон "ONNX ASR" в магазине и нажмите **"Установить"**.

## Как использовать

После установки надо выбрать модель и запустить аддон. Аддон можен быть найден системой автоматически. Если это не произошло, используйте название контейнера, как хост, и порт 10305.

[![Open your Home Assistant instance and start setting up a new integration.](https://my.home-assistant.io/badges/config_flow_start.svg)](https://my.home-assistant.io/redirect/config_flow_start/?domain=wyoming)

После этого вы сможете выбрать "ONNX ASR" в качестве движка распознавания речи в настройках голосовых ассистентов.

## Модели и хранение

При первом запуске с выбранной моделью аддон автоматически скачает ее из интернета. Чтобы избежать повторной загрузки при обновлениях, модели сохраняются в папку `share` вашего Home Assistant.

**Путь хранения моделей:** `/share/onnxasr/.cache/`

Вы можете управлять этими файлами, например, через аддон "Samba share" или "File editor".

## Конфигурация

### Опция: `model`

Выбор модели для распознавания речи. Модели отличаются размером, скоростью и точностью. Для русского актуальны `gigaam-v2-ctc` [900/240], `vosk-model-ru` [260/75], `vosk-model-small-ru` [90/25], в скобках полный размер и int8.

### Опция: `quantization`

Выбор квантизации модели. Это влияет на размер модели и скорость работы. Для разных моделей доступны разные варианты:
-   **int8**: Самый маленький размер и самая высокая скорость. Точность может быть немного ниже. Идеально для одноплатных компьютеров вроде Raspberry Pi.
-   **fp16**: Средний вариант (не для всех моделей).
-   **fp32**: Полная (неквантизированная) модель. Самый большой размер и самая высокая точность, но требует больше ресурсов.

### Опция: `device`

Устройство для вычислений:
-   **cpu**: Стандартный вариант, работает на любом устройстве.
-   **cuda**: Использовать видеокарту NVIDIA для ускорения. **Внимание:** требует наличия совместимой видеокарты и правильно настроенных драйверов на хост-системе. Этот режим предназначен для продвинутых пользователей.

### Опция: `debug`

Включает подробное логирование в журнале аддона. Полезно для диагностики проблем.
